# Claude Project Memory

## ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó (Role)
- Expert Full Stack Developer

## ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Goal)
- ‡∏ä‡πà‡∏ß‡∏¢‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤‡∏£‡∏¥‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå

## ‡∏†‡∏≤‡∏©‡∏≤ (Language)
- ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Workflow)
- ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏î‡πÜ ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏≤‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ (Project Structure)
- Client: React frontend application
- Server: Node.js backend API
- Docker: Containerized deployment configuration

## ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Important Commands)
```bash
# Frontend (Client)
cd client
npm install
npm start

# Backend (Server)
cd server
npm install
npm start

# Docker
docker-compose up -d
```

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Important Notes)
- ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠
- ‡πÉ‡∏ä‡πâ Docker ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ deploy
- ‡∏°‡∏µ frontend ‡πÅ‡∏•‡∏∞ backend ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (Latest Status)

### üìÖ **Update: 10 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2025**

#### üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Code ‡πÉ‡∏ô Docker

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö:**
1. User restore version ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ CLAUDE.md
2. Login endpoint ‡πÉ‡∏ä‡πâ `user.password` ‡πÅ‡∏ó‡∏ô `user.password_hash` (Bug)

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Login Bug** ‚úÖ
   - ‡πÑ‡∏ü‡∏•‡πå: `server/index.js:1444`
   - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å: `comparePassword(password, user.password)`
   - ‡πÄ‡∏õ‡πá‡∏ô: `comparePassword(password, user.password_hash)`
   - Rebuild Docker image ‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Loan Problems & Action Plans** ‚úÖ
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á test script: `test-add-customer.sh`
   - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°:
     - 3 Loan Problems: "‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏π‡∏á", "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏û‡∏≠", "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô"
     - 3 Action Plans: "‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ", "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", "‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô"
   - ‚úÖ POST /api/customers - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
   - ‚úÖ GET /api/customers/:id - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
   - ‚úÖ Database (loan_problems, action_plans) - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:**
- ‚úÖ Login ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‚úÖ Loan Problems ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- ‚úÖ Action Plans ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- ‚úÖ API Response ‡∏°‡∏µ structure ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

### ‚úÖ ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (Completed)

#### 1. MySQL Database Setup
- Database: `jaidee_db`
- User: `jaidee_user`
- Password: `jaidee123`
- Tables: customers, loan_problems, action_plans, bank_rules, reports, users

#### 2. Loan Problems & Action Plans System
- **server/database.js**
  - ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ filter undefined/null/empty string ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 229-230, 243-244, 315-330)
  - Function `insertCustomerWithDetails()` ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
  - Function `updateCustomerWithDetails()` ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
  - Function `getCustomerWithDetails()` ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• loanProblems ‡πÅ‡∏•‡∏∞ actionPlans ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

- **server/index.js**
  - POST /api/customers - ‡∏™‡πà‡∏á loanProblem ‡πÅ‡∏•‡∏∞ actionPlan parameters ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1667-1671)
  - PUT /api/customers/:id - ‡∏™‡πà‡∏á loanProblem ‡πÅ‡∏•‡∏∞ actionPlan parameters ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1773-1778)

#### 3. Authentication System
- Login endpoint ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ä‡πâ `password_hash` ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- JWT Token generation ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
- User roles: admin, data_entry, data_user

## üìä KPI Calculation Logic

### 1. **Potential Score (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û)**
‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô:

```javascript
Potential Score = (actionPlanProgress √ó 0.5) + (dsrScore √ó 0.5)
```

**DSR Score** ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å DSR (Debt Service Ratio):
- DSR < 40% ‚Üí **100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô** (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°)
- DSR 40-60% ‚Üí **75 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô** (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á)
- DSR > 60% ‚Üí **50 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô** (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)

**‡∏™‡∏π‡∏ï‡∏£ DSR:**
```
DSR = (‡∏´‡∏ô‡∏µ‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô / ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ) √ó 100
```

---

## üìã To-Do List ‡∏ï‡πà‡∏≠‡πÑ‡∏õ

### üî¥ Priority 1: Security & Environment (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)
- [ ] **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç hardcoded secrets** ‡πÉ‡∏ô production
  - `server/auth.js:5` - JWT_SECRET ‚Üí ‡πÉ‡∏ä‡πâ environment variable
  - `server/index.js:59` - session secret ‚Üí ‡πÉ‡∏ä‡πâ environment variable
  - `server/auth.js:128,140,151` - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô default passwords
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env.example` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö server
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Docker environment variables ‡πÉ‡∏ô `docker-compose.mysql.yml`

### üü° Priority 2: Testing & Bug Fixes
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (PUT endpoint) ‡∏û‡∏£‡πâ‡∏≠‡∏° Loan Problems
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö Loan Problems / Action Plans
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö edge cases (empty arrays, null values, etc.)
- [ ] ‡πÅ‡∏Å‡πâ MySQL configuration warnings (acquireTimeout, timeout, reconnect)
- [ ] ‡πÅ‡∏Å‡πâ Session Store warning (‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Redis ‡πÅ‡∏ó‡∏ô MemoryStore)

### üü¢ Priority 3: Database & Performance
- [ ] Review ‡πÅ‡∏•‡∏∞ optimize MySQL queries
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ database indexes ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
- [ ] Backup strategy ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production database

### üîµ Priority 4: Features & Improvements
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° error handling ‡πÅ‡∏•‡∏∞ logging ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
- [ ] Documentation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API endpoints
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° validation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö input data

---

## üõ†Ô∏è Tools & Scripts

### test-add-customer.sh
Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° Loan Problems ‡πÅ‡∏•‡∏∞ Action Plans

```bash
./test-add-customer.sh
```

### Docker Commands
```bash
# Start with MySQL
docker-compose -f docker-compose.mysql.yml up -d

# Rebuild backend after code changes
docker-compose -f docker-compose.mysql.yml build backend
docker-compose -f docker-compose.mysql.yml up -d backend

# View logs
docker logs jaidee-backend --tail 50

# Access phpMyAdmin
http://localhost:8080
```

---

## üìå Known Issues

### MySQL2 Warnings (‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á)
```
Ignoring invalid configuration option passed to Connection: acquireTimeout
Ignoring invalid configuration option passed to Connection: timeout
Ignoring invalid configuration option passed to Connection: reconnect
```
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏Ñ‡∏ß‡∏£‡∏•‡∏ö options ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å `database.js` ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô Pool config

### Session Store Warning
```
Warning: connect.session() MemoryStore is not designed for a production environment
```
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Redis-based session store ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production
